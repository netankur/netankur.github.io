<html class="scroll-smooth" lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   QR Code Generator
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js">
  </script>
 </head>
 <body class="bg-gradient-to-br from-indigo-50 via-white to-indigo-50 min-h-screen flex flex-col p-6">
  <main class="flex flex-col md:flex-row flex-grow w-full max-w-7xl mx-auto gap-10">
   <form class="flex-grow space-y-6" id="qr-form" novalidate="">
    <div>
     <label class="block text-indigo-800 font-semibold mb-2 text-lg" for="type-select">
      Select QR Code Type
     </label>
     <select aria-label="Select QR Code Type" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="type-select" name="type-select">
      <option value="text">
       Text
      </option>
      <option value="url">
       URL
      </option>
      <option value="vcard">
       vCard
      </option>
      <option value="email">
       Email
      </option>
      <option value="wifi">
       WiFi
      </option>
     </select>
    </div>
    <!-- Input groups -->
    <div class="input-group" data-type="text url">
     <label class="block text-indigo-800 font-semibold mb-2" for="text-input">
      Enter Text or URL
     </label>
     <input aria-describedby="text-input-desc" autocomplete="off" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="text-input" name="text-input" placeholder="Enter text or URL" type="text"/>
     <p class="text-indigo-500 text-sm mt-1" id="text-input-desc">
      Any text or website URL
     </p>
    </div>
    <div class="input-group hidden space-y-4" data-type="vcard">
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-firstname">
       First Name
      </label>
      <input autocomplete="given-name" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="vcard-firstname" name="vcard-firstname" placeholder="John" type="text"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-lastname">
       Last Name
      </label>
      <input autocomplete="family-name" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="vcard-lastname" name="vcard-lastname" placeholder="Doe" type="text"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-org">
       Organization
      </label>
      <input autocomplete="organization" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="vcard-org" name="vcard-org" placeholder="Company Inc." type="text"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-title">
       Title
      </label>
      <input autocomplete="organization-title" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="vcard-title" name="vcard-title" placeholder="Software Engineer" type="text"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-phone">
       Phone
      </label>
      <input autocomplete="tel" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="vcard-phone" name="vcard-phone" placeholder="+1 234 567 890" type="tel"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-email">
       Email
      </label>
      <input autocomplete="email" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="vcard-email" name="vcard-email" placeholder="john.doe@example.com" type="email"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-url">
       Website
      </label>
      <input autocomplete="url" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="vcard-url" name="vcard-url" placeholder="https://example.com" type="url"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="vcard-address">
       Address
      </label>
      <textarea aria-multiline="true" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition resize-y" id="vcard-address" name="vcard-address" placeholder="123 Main St, City, Country" rows="2"></textarea>
     </div>
    </div>
    <div class="input-group hidden space-y-4" data-type="email">
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="email-to">
       To (Email Address)
      </label>
      <input autocomplete="email" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="email-to" name="email-to" placeholder="recipient@example.com" type="email"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="email-subject">
       Subject
      </label>
      <input autocomplete="off" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="email-subject" name="email-subject" placeholder="Subject" type="text"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="email-body">
       Body
      </label>
      <textarea aria-multiline="true" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition resize-y" id="email-body" name="email-body" placeholder="Write your message here..." rows="3"></textarea>
     </div>
    </div>
    <div class="input-group hidden space-y-4" data-type="wifi">
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="wifi-ssid">
       SSID (Network Name)
      </label>
      <input autocomplete="off" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="wifi-ssid" name="wifi-ssid" placeholder="MyWiFiNetwork" type="text"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="wifi-password">
       Password
      </label>
      <input autocomplete="off" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium placeholder-indigo-400 focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="wifi-password" name="wifi-password" placeholder="password123" type="text"/>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="wifi-encryption">
       Encryption
      </label>
      <select aria-label="WiFi Encryption Type" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="wifi-encryption" name="wifi-encryption">
       <option value="WPA">
        WPA/WPA2
       </option>
       <option value="WEP">
        WEP
       </option>
       <option value="nopass">
        None
       </option>
      </select>
     </div>
     <div>
      <label class="block text-indigo-800 font-semibold mb-2" for="wifi-hidden">
       Hidden Network
      </label>
      <select aria-label="WiFi Hidden Network" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="wifi-hidden" name="wifi-hidden">
       <option selected="" value="false">
        No
       </option>
       <option value="true">
        Yes
       </option>
      </select>
     </div>
    </div>
    <!-- Additional options toggle -->
    <div class="border-t border-indigo-300 pt-6">
     <button aria-controls="additional-options" aria-expanded="false" class="w-full flex items-center justify-between text-indigo-900 font-semibold text-lg focus:outline-none focus:ring-4 focus:ring-indigo-400 rounded-lg px-4 py-3 hover:bg-indigo-100 transition" id="toggle-options-btn" type="button">
      Additional Options
      <i class="fas fa-chevron-down transition-transform duration-300" id="toggle-icon">
      </i>
     </button>
     <div aria-hidden="true" class="mt-4 hidden space-y-5" id="additional-options">
      <div>
       <label class="block text-indigo-800 font-semibold mb-2" for="color-dark">
        Dark Color
       </label>
       <input aria-label="Dark color for QR code dots" class="w-full h-12 p-1 border border-indigo-300 rounded-lg cursor-pointer" id="color-dark" name="color-dark" type="color" value="#000000"/>
      </div>
      <div>
       <label class="block text-indigo-800 font-semibold mb-2" for="color-light">
        Light Color
       </label>
       <input aria-label="Light color for QR code background" class="w-full h-12 p-1 border border-indigo-300 rounded-lg cursor-pointer" id="color-light" name="color-light" type="color" value="#ffffff"/>
      </div>
      <div>
       <label class="block text-indigo-800 font-semibold mb-2" for="error-correction">
        Error Correction Level
       </label>
       <select aria-label="Error correction level" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="error-correction" name="error-correction">
        <option value="L">
         Low (7%)
        </option>
        <option selected="" value="M">
         Medium (15%)
        </option>
        <option value="Q">
         Quartile (25%)
        </option>
        <option value="H">
         High (30%)
        </option>
       </select>
      </div>
      <div>
       <label class="block text-indigo-800 font-semibold mb-2" for="margin">
        Margin (modules)
       </label>
       <input aria-label="Margin around QR code in modules" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="margin" max="50" min="0" name="margin" type="number" value="2"/>
      </div>
      <div>
       <label class="block text-indigo-800 font-semibold mb-2" for="scale">
        Scale (size multiplier)
       </label>
       <input aria-label="Scale multiplier for QR code size" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="scale" max="20" min="1" name="scale" type="number" value="8"/>
      </div>
      <div>
       <label class="block text-indigo-800 font-semibold mb-2" for="dot-style">
        Dot Style
       </label>
       <select aria-label="Dot style for QR code" class="w-full border border-indigo-300 rounded-lg px-4 py-3 text-indigo-900 text-lg font-medium focus:outline-none focus:ring-4 focus:ring-indigo-400 transition" id="dot-style" name="dot-style">
        <option selected="" value="square">
         Square
        </option>
        <option value="round">
         Round
        </option>
       </select>
      </div>
     </div>
    </div>
    <button aria-label="Generate QR code" class="w-full bg-indigo-700 hover:bg-indigo-800 text-white font-extrabold py-4 rounded-lg text-xl shadow-lg transition-colors duration-300 focus:outline-none focus:ring-4 focus:ring-indigo-500" id="generate-btn" type="button">
     <i class="fas fa-qrcode mr-3">
     </i>
     Generate QR Code
    </button>
   </form>
   <section aria-label="Generated QR code and download" class="flex flex-col items-center justify-center space-y-6 w-full max-w-md">
    <div class="w-full aspect-square bg-white rounded-lg shadow-xl flex items-center justify-center border-4 border-indigo-300">
     <img alt="Placeholder image showing a blank QR code area with text 'QR Code Will Appear Here'" class="w-11/12 h-11/12 object-contain rounded-lg" height="auto" id="qr-code" src="https://placehold.co/224x224/png?text=QR+Code+Will+Appear+Here" width="auto"/>
    </div>
    <a aria-label="Download generated QR code" class="hidden bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-8 rounded-lg shadow-lg transition-colors duration-300 flex items-center space-x-3 focus:outline-none focus:ring-4 focus:ring-indigo-500" download="qrcode.png" href="#" id="download-btn" role="button" tabindex="0">
     <i class="fas fa-download text-lg">
     </i>
     <span>
      Download QR Code
     </span>
    </a>
   </section>
  </main>
  <script>
   const typeSelect = document.getElementById("type-select");
    const form = document.getElementById("qr-form");
    const generateBtn = document.getElementById("generate-btn");
    const qrCodeImg = document.getElementById("qr-code");
    const downloadBtn = document.getElementById("download-btn");
    const inputGroups = form.querySelectorAll(".input-group");
    const toggleOptionsBtn = document.getElementById("toggle-options-btn");
    const additionalOptions = document.getElementById("additional-options");
    const toggleIcon = document.getElementById("toggle-icon");

    function showInputsForType(type) {
      inputGroups.forEach((group) => {
        const types = group.getAttribute("data-type").split(" ");
        if (types.includes(type)) {
          group.classList.remove("hidden");
        } else {
          group.classList.add("hidden");
        }
      });
    }

    typeSelect.addEventListener("change", () => {
      showInputsForType(typeSelect.value);
      qrCodeImg.src = "https://placehold.co/224x224/png?text=QR+Code+Will+Appear+Here";
      qrCodeImg.alt = "Placeholder image showing a blank QR code area with text 'QR Code Will Appear Here'";
      downloadBtn.classList.add("hidden");
    });

    toggleOptionsBtn?.addEventListener("click", () => {
      const expanded = toggleOptionsBtn.getAttribute("aria-expanded") === "true";
      toggleOptionsBtn.setAttribute("aria-expanded", !expanded);
      additionalOptions.classList.toggle("hidden");
      additionalOptions.setAttribute("aria-hidden", expanded);
      toggleIcon.style.transform = expanded ? "rotate(0deg)" : "rotate(180deg)";
    });

    function generateVCard(data) {
      let vcard = "BEGIN:VCARD\nVERSION:3.0\n";
      if (data.firstname || data.lastname) {
        vcard += `N:${data.lastname || ""};${data.firstname || ""};;;\n`;
        vcard += `FN:${data.firstname || ""} ${data.lastname || ""}\n`;
      }
      if (data.org) vcard += `ORG:${data.org}\n`;
      if (data.title) vcard += `TITLE:${data.title}\n`;
      if (data.phone) vcard += `TEL;TYPE=WORK,VOICE:${data.phone}\n`;
      if (data.email) vcard += `EMAIL;TYPE=PREF,INTERNET:${data.email}\n`;
      if (data.url) vcard += `URL:${data.url}\n`;
      if (data.address) vcard += `ADR;TYPE=WORK:;;${data.address.replace(/\n/g, ";")}\n`;
      vcard += "END:VCARD";
      return vcard;
    }

    function generateEmail(data) {
      const to = encodeURIComponent(data.to || "");
      const subject = encodeURIComponent(data.subject || "");
      const body = encodeURIComponent(data.body || "");
      return `mailto:${to}?subject=${subject}&body=${body}`;
    }

    function generateWiFi(data) {
      const type = data.encryption || "WPA";
      const ssid = data.ssid || "";
      const password = data.password || "";
      const hidden = data.hidden === "true" ? "true" : "false";
      return `WIFI:T:${type};S:${ssid};P:${password};H:${hidden};;`;
    }

    function drawRoundedQRCode(text, options, callback) {
      try {
        const qr = QRCode.create(text, { errorCorrectionLevel: options.errorCorrectionLevel });
        const modules = qr.modules;
        const size = modules.size;
        const scale = options.scale;
        const margin = options.margin;

        const canvasSize = (size + margin * 2) * scale;
        const canvas = document.createElement("canvas");
        canvas.width = canvasSize;
        canvas.height = canvasSize;
        const ctx = canvas.getContext("2d");

        ctx.fillStyle = options.colorLight;
        ctx.fillRect(0, 0, canvasSize, canvasSize);

        ctx.fillStyle = options.colorDark;

        for (let r = 0; r < size; r++) {
          for (let c = 0; c < size; c++) {
            if (modules.get(r, c)) {
              const x = (c + margin) * scale;
              const y = (r + margin) * scale;
              if (options.dotStyle === "round") {
                const radius = scale / 2;
                ctx.beginPath();
                ctx.arc(x + radius, y + radius, radius * 0.85, 0, 2 * Math.PI);
                ctx.fill();
              } else {
                ctx.fillRect(x, y, scale, scale);
              }
            }
          }
        }
        callback(null, canvas.toDataURL());
      } catch (e) {
        callback(e, null);
      }
    }

    generateBtn.addEventListener("click", () => {
      const type = typeSelect.value;
      let qrText = "";
      if (type === "text" || type === "url") {
        const textInput = form.querySelector('input[name="text-input"]');
        if (!textInput.value.trim()) {
          alert("Please enter text or URL.");
          return;
        }
        qrText = textInput.value.trim();
      } else if (type === "vcard") {
        const data = {
          firstname: form.querySelector('input[name="vcard-firstname"]').value.trim(),
          lastname: form.querySelector('input[name="vcard-lastname"]').value.trim(),
          org: form.querySelector('input[name="vcard-org"]').value.trim(),
          title: form.querySelector('input[name="vcard-title"]').value.trim(),
          phone: form.querySelector('input[name="vcard-phone"]').value.trim(),
          email: form.querySelector('input[name="vcard-email"]').value.trim(),
          url: form.querySelector('input[name="vcard-url"]').value.trim(),
          address: form.querySelector('textarea[name="vcard-address"]').value.trim(),
        };
        if (!data.firstname && !data.lastname) {
          alert("Please enter at least a first name or last name for vCard.");
          return;
        }
        qrText = generateVCard(data);
      } else if (type === "email") {
        const data = {
          to: form.querySelector('input[name="email-to"]').value.trim(),
          subject: form.querySelector('input[name="email-subject"]').value.trim(),
          body: form.querySelector('textarea[name="email-body"]').value.trim(),
        };
        if (!data.to) {
          alert("Please enter recipient email address.");
          return;
        }
        qrText = generateEmail(data);
      } else if (type === "wifi") {
        const data = {
          ssid: form.querySelector('input[name="wifi-ssid"]').value.trim(),
          password: form.querySelector('input[name="wifi-password"]').value.trim(),
          encryption: form.querySelector('select[name="wifi-encryption"]').value,
          hidden: form.querySelector('select[name="wifi-hidden"]').value,
        };
        if (!data.ssid) {
          alert("Please enter WiFi SSID.");
          return;
        }
        if (data.encryption !== "nopass" && !data.password) {
          alert("Please enter WiFi password.");
          return;
        }
        qrText = generateWiFi(data);
      }

      const colorDark = form.querySelector('input[name="color-dark"]').value || "#000000";
      const colorLight = form.querySelector('input[name="color-light"]').value || "#ffffff";
      const errorCorrectionLevel = form.querySelector('select[name="error-correction"]').value || "M";
      let margin = parseInt(form.querySelector('input[name="margin"]').value, 10);
      if (isNaN(margin) || margin < 0) margin = 2;
      let scale = parseInt(form.querySelector('input[name="scale"]').value, 10);
      if (isNaN(scale) || scale < 1) scale = 8;
      const dotStyle = form.querySelector('select[name="dot-style"]').value || "square";

      if (dotStyle === "square") {
        QRCode.toDataURL(
          qrText,
          {
            margin: margin,
            color: {
              dark: colorDark,
              light: colorLight,
            },
            errorCorrectionLevel: errorCorrectionLevel,
            scale: scale,
          },
          (err, url) => {
            if (err) {
              alert("Failed to generate QR code.");
              return;
            }
            qrCodeImg.src = url;
            qrCodeImg.alt = `QR code representing the ${type} data`;
            downloadBtn.href = url;
            downloadBtn.classList.remove("hidden");
          }
        );
      } else {
        drawRoundedQRCode(
          qrText,
          {
            colorDark,
            colorLight,
            errorCorrectionLevel,
            margin,
            scale,
            dotStyle,
          },
          (err, url) => {
            if (err) {
              alert("Failed to generate QR code.");
              return;
            }
            qrCodeImg.src = url;
            qrCodeImg.alt = `QR code representing the ${type} data with rounded dots`;
            downloadBtn.href = url;
            downloadBtn.classList.remove("hidden");
          }
        );
      }
    });

    // Initialize inputs visibility on page load
    showInputsForType(typeSelect.value);
  </script>
 </body>
</html>